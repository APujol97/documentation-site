<div>
    <table id="table_deprecated" class="table table-condensed table-bordered"></table>
    <style>
        td,
        th {
            word-wrap: break-word;
        }

        .inner-table td {
            border: none !important;
        }

        .info-hidden, .isRowHidden {
            display: none;
        }
    </style>
    <script>

        // let otherLog
        $(document).ready(function () {
            const log = {{.Page.Params.log }}
            createTable(log);
        });


        function createTable(log) {
            const keys = Object.keys(log);

            const $table = $('#table_deprecated');
            const $tbodies = [];

            for (const [key, fields] of Object.entries(log)) {
                const $tbody = $(`<tbody date=${key}>`);
                const fieldLength = fields.length;
                $tbody.append($("<tr>").append($(`<td rowspan=${fieldLength + 1} colspan="1">${key}</td><td class="isRowHidden" colspan="3">SHOW DEPRECATED FIELDS</td>`).click(function(){
                    const $elem = $(this);
                    const $isRowHidden = $elem.parent().children().last();

                    const time = ($isRowHidden.css('display') === 'none') ? 300 : 0;
                    console.log(time);
                    setTimeout(_=>$isRowHidden.toggleClass('isRowHidden'), time);   

                    $elem.parent().siblings('tr').fadeToggle();                                    
                })));

                $trs = [];
                for (const field of fields) {
                    const $tr = $(`<tr fname=${field.name}>`);
                    const $td = $(`<td colspan="3">`);

                    const $tdTable = buildInnerTable(field);

                    $td.append($tdTable)

                    $tr.append($td);
                    $trs.push($tr);
                }

                $trs.map($tr => $tbody.append($tr));

                $tbodies.push($tbody);
            }
            $tbodies.map($tbody => $table.append($tbody))
        }


        function buildInnerTable(field) {
            $tdTable = $('<table>').addClass('table table-condensed inner-table');
            //Build inner table head body
            const $tdTableHB = $('<tbody>');
            const $tdTableHBTitles = $('<tr>').append($('<th>').text('Name'));
            const $tdTableHBData = $('<tr>').append($('<td>').text(field.name));

            $tdTableHB.append($tdTableHBTitles);
            $tdTableHB.append($tdTableHBData);

            //Event to show info div 
            $tdTableHB.click(function () {
                console.log(this);
                $(this).next().toggleClass('info-hidden');
            });

            $tdTable.append($tdTableHB);


            //Build inner table information body
            const $tdTableInfoBody = $('<tbody>').addClass('info-hidden');
            const $tdTableInfoBodyData = $('<tr>').append($('<td>').append($('<div>').text("INFORMATION")));

            $tdTableInfoBody.append($tdTableInfoBodyData);

            $tdTable.append($tdTableInfoBody);

            return $tdTable;
        }
    </script>
</div>